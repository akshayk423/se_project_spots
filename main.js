!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit",inactiveButtonClass:"modal__submit_type_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},r=(e,t,r)=>{const n=e.querySelector(`#${t.id}-error`);t.classList.remove(r.inputErrorClass),n.textContent="",n.classList.add(r.errorClass)},n=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?s(t,r):o(t,r)},s=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},o=(e,t)=>{e.classList.remove(t.inactiveButtonClass),e.disabled=!1};var a=e+"d3610e9c6dce3cb370d8.svg",c=e+"1ecf96fab54a91c898b4.svg",i=e+"40608da7369d39bc1077.svg";const d=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then(this._checkResponse)}addCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{headers:this._headers,method:"DELETE",body:JSON.stringify({cardId:e})}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"PUT",body:JSON.stringify({cardId:e})}).then(this._checkResponse)}dislikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{headers:this._headers,method:"DELETE",body:JSON.stringify({cardId:e})}).then(this._checkResponse)}spotsStartUp(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"6e58b2db-8c6b-4765-b44f-89c77c553815","Content-Type":"application/json"}}),l=document.querySelector(".profile__name"),u=document.querySelector(".profile__description"),m=document.querySelector(".profile__avatar");document.getElementById("spots-logo").src=a,document.getElementById("edit-icon").src=c,document.getElementById("plus-icon").src=i;const h=document.querySelector(".profile__edit-profile-btn"),_=document.querySelector("#edit-profile-modal"),b=document.forms.profile,f=document.querySelector(".profile__new-post-btn"),p=document.querySelector("#new-post-modal"),y=document.forms.newPost,v=document.querySelector("#delete-card-modal"),S=document.querySelector(".modal__delete-btn"),k=document.querySelector(".modal__cancel-btn"),q=document.querySelector(".profile__avatar-edit-btn"),C=document.querySelector("#edit-avatar-modal"),g=document.forms.avatar,E=document.querySelector("#avatar-link-input"),L=document.querySelector(".profile__column"),U=L.querySelector(".profile__name"),x=L.querySelector(".profile__description"),$=_.querySelector("#profile-name-input"),A=_.querySelector("#describe-input"),I=p.querySelector("#image-link-input"),B=p.querySelector("#caption-input"),R=document.querySelector(".cards__list"),D=document.querySelector("#modal-image"),w=D.querySelector(".modal__image"),N=D.querySelector(".modal__caption"),O=document.querySelector("#card-template").content;let P,T;function J(e){"Escape"===e.key&&H(document.querySelector(".modal_is-opened"))}function j(e){e.classList.add("modal_is-opened"),document.addEventListener("keydown",J)}function H(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",J)}function z(e,t="prepend"){const r=function(e){const t=O.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__text"),n=t.querySelector(".card__image");n.setAttribute("src",e.link),n.setAttribute("alt",e.name),r.textContent=e.name;const s=t.querySelector(".card__like-btn");return e.isLiked&&s.classList.toggle("card__like-btn_liked"),s.addEventListener("click",t=>{var r,n;r=t.target,n=e._id,e.isLiked?d.dislikeCard(n).then(()=>r.classList.toggle("card__like-btn_liked")).catch(e=>console.error(e)):d.likeCard(n).then(()=>r.classList.toggle("card__like-btn_liked")).catch(e=>console.error(e))}),t.querySelector(".card__delete-btn").addEventListener("click",r=>{!function(e,t){P=e,T=t,j(v)}(t,e._id)}),n.addEventListener("click",()=>{w.setAttribute("src",e.link),w.setAttribute("alt",e.name),N.textContent=e.name,j(D)}),t}(e);R[t](r)}function M(e,t){console.log(error),t.submitter.disabled=!1}function F(e){e.submitter.textContent="Save",s(e.submitter,t)}var G;document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("mousedown",t=>{(t.target===e||t.target.classList.contains("modal__close-btn"))&&H(e)})}),q.addEventListener("click",()=>{j(C)}),h.addEventListener("click",function(){j(_),$.value=U.textContent,A.value=x.textContent,((e,t,s)=>{t.forEach(t=>{r(e,t,s)});const o=e.querySelector(s.submitButtonSelector);n(t,o,s)})(b,[$,A],t)}),f.addEventListener("click",function(){j(p)}),b.addEventListener("submit",e=>{e.preventDefault();const t=$.value,r=A.value;e.submitter.textContent="Saving...",e.submitter.disabled=!0,d.editUserInfo({name:t,about:r}).then(e=>{l.textContent=e.name,u.textContent=e.about,H(_)}).catch(t=>M(0,e)).finally(()=>F(e))}),k.addEventListener("click",()=>{H(v)}),y.addEventListener("submit",e=>{e.preventDefault();const t=B.value,r=I.value;e.submitter.textContent="Saving...",e.submitter.disabled=!0,d.addCard({name:t,link:r}).then(e=>{z(e),y.reset(),H(p)}).catch(t=>M(0,e)).finally(()=>F(e))}),S.addEventListener("click",function(){S.textContent="Deleting...",d.deleteCard(T).then(()=>{P.remove(),H(v)}).catch(e=>console.error(e)).finally(()=>{S.textContent="Delete"})}),g.addEventListener("submit",e=>{e.preventDefault();const t=E.value;e.submitter.textContent="Saving...",e.submitter.disabled=!0,d.editUserAvatar(t).then(e=>{m.src=e.avatar,H(C),g.reset()}).catch(t=>M(0,e)).finally(()=>F(e))}),G=t,Array.from(document.querySelectorAll(G.formSelector)).forEach(e=>{e.addEventListener("submit",function(e){e.preventDefault()}),((e,t)=>{const s=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n(s,o,t),s.forEach(a=>{a.addEventListener("input",function(){((e,t,n)=>{t.validity.valid?r(e,t,n):((e,t,r,n)=>{const s=e.querySelector(`#${t.id}-error`);t.classList.add(n.inputErrorClass),s.textContent=r,s.classList.add(n.errorClass)})(e,t,t.validationMessage,n)})(e,a,t),n(s,o,t)})})})(e,G)}),d.spotsStartUp().then(e=>{const[t,r]=e;l.textContent=r.name,u.textContent=r.about,m.src=r.avatar,t.forEach(e=>z(e,"append"))}).catch(e=>{console.error(e)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQ0EsSUFBSUEsRUNEb0IsR0NBakIsTUFBTUMsRUFBbUIsQ0FDOUJDLGFBQWMsZUFDZEMsY0FBZSxnQkFDZkMscUJBQXNCLGlCQUN0QkMsb0JBQXFCLDhCQUNyQkMsZ0JBQWlCLDBCQUNqQkMsV0FBWSx3QkFVUkMsRUFBaUJBLENBQUNDLEVBQWFDLEVBQWNDLEtBQ2pELE1BQU1DLEVBQWVILEVBQVlJLGNBQWMsSUFBSUgsRUFBYUksWUFDaEVKLEVBQWFLLFVBQVVDLE9BQU9MLEVBQU9MLGlCQUNyQ00sRUFBYUssWUFBYyxHQUMzQkwsRUFBYUcsVUFBVUcsSUFBSVAsRUFBT0osYUFzQjlCWSxFQUFvQkEsQ0FBQ0MsRUFBV0MsRUFBZVYsS0FONUJTLElBQ2hCQSxFQUFVRSxLQUFNWixJQUNiQSxFQUFhYSxTQUFTQyxPQUs1QkMsQ0FBZ0JMLEdBQ2xCTSxFQUFjTCxFQUFlVixHQUU3QmdCLEVBQWFOLEVBQWVWLElBSW5CZSxFQUFnQkEsQ0FBQ0wsRUFBZVYsS0FDM0NVLEVBQWNOLFVBQVVHLElBQUlQLEVBQU9OLHFCQUNuQ2dCLEVBQWNPLFVBQVcsR0FHckJELEVBQWVBLENBQUNOLEVBQWVWLEtBQ25DVSxFQUFjTixVQUFVQyxPQUFPTCxFQUFPTixxQkFDdENnQixFQUFjTyxVQUFXLEcsaUdDNUMzQixNQUFNQyxFQUFNLElDYkcsTUFDYkMsV0FBQUEsQ0FBWUMsR0FDVkMsS0FBS0MsU0FBV0YsRUFBUUcsUUFDeEJGLEtBQUtHLFNBQVdKLEVBQVFLLE9BQzFCLENBRUFDLGVBQUFBLEdBQ0UsT0FBT0MsTUFBTSxHQUFHTixLQUFLQyxpQkFBa0IsQ0FDckNHLFFBQVNKLEtBQUtHLFdBQ2JJLEtBQUtQLEtBQUtRLGVBQ2YsQ0FFQUMsV0FBQUEsR0FDRSxPQUFPSCxNQUFNLEdBQUdOLEtBQUtDLG9CQUFxQixDQUN4Q0csUUFBU0osS0FBS0csV0FDYkksS0FBS1AsS0FBS1EsZUFDZixDQUVBRSxZQUFBQSxFQUFhLEtBQUVDLEVBQUksTUFBRUMsSUFDbkIsT0FBT04sTUFBTSxHQUFHTixLQUFLQyxvQkFBcUIsQ0FDeENZLE9BQVEsUUFDUlQsUUFBU0osS0FBS0csU0FDZFcsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkwsT0FDQUMsWUFFREwsS0FBS1AsS0FBS1EsZUFDZixDQUVBUyxjQUFBQSxDQUFlQyxHQUNiLE9BQU9aLE1BQU0sR0FBR04sS0FBS0MsMkJBQTRCLENBQy9DRyxRQUFTSixLQUFLRyxTQUNkVSxPQUFRLFFBQ1JDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJFLGFBRURYLEtBQUtQLEtBQUtRLGVBQ2YsQ0FFQVcsT0FBQUEsRUFBUSxLQUFFUixFQUFJLEtBQUVTLElBQ2QsT0FBT2QsTUFBTSxHQUFHTixLQUFLQyxpQkFBa0IsQ0FDckNZLE9BQVEsT0FDUlQsUUFBU0osS0FBS0csU0FDZFcsS0FBTUMsS0FBS0MsVUFBVSxDQUFFTCxPQUFNUyxXQUM1QmIsS0FBS1AsS0FBS1EsZUFDZixDQUVBYSxVQUFBQSxDQUFXQyxHQUNULE9BQU9oQixNQUFNLEdBQUdOLEtBQUtDLGtCQUFrQnFCLElBQVUsQ0FDL0NsQixRQUFTSixLQUFLRyxTQUNkVSxPQUFRLFNBQ1JDLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJNLGFBRURmLEtBQUtQLEtBQUtRLGVBQ2YsQ0FFQWUsUUFBQUEsQ0FBU0QsR0FDUCxPQUFPaEIsTUFBTSxHQUFHTixLQUFLQyxrQkFBa0JxQixVQUFnQixDQUNyRGxCLFFBQVNKLEtBQUtHLFNBQ2RVLE9BQVEsTUFDUkMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQk0sYUFFRGYsS0FBS1AsS0FBS1EsZUFDZixDQUVBZ0IsV0FBQUEsQ0FBWUYsR0FDVixPQUFPaEIsTUFBTSxHQUFHTixLQUFLQyxrQkFBa0JxQixVQUFnQixDQUNyRGxCLFFBQVNKLEtBQUtHLFNBQ2RVLE9BQVEsU0FDUkMsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQk0sYUFFRGYsS0FBS1AsS0FBS1EsZUFDZixDQUdBaUIsWUFBQUEsR0FDRSxPQUFPQyxRQUFRQyxJQUFJLENBQUMzQixLQUFLSyxrQkFBbUJMLEtBQUtTLGVBQ25ELENBRUFELGNBQUFBLENBQWVvQixHQUNiLE9BQUlBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5KLFFBQVFLLE9BQU8sVUFBVUgsRUFBSUksU0FDdEMsR0QxRWtCLENBQ2xCOUIsUUFBUyxrREFDVEUsUUFBUyxDQUNQNkIsY0FBZSx1Q0FDZixlQUFnQixzQkFJZEMsRUFBa0JDLFNBQVN0RCxjQUFjLGtCQUN6Q3VELEVBQW1CRCxTQUFTdEQsY0FBYyx5QkFDMUN3RCxFQUFvQkYsU0FBU3RELGNBQWMsb0JBRy9Cc0QsU0FBU0csZUFBZSxjQUNoQ0MsSUFBTUMsRUFFQ0wsU0FBU0csZUFBZSxhQUNoQ0MsSUFBTUUsRUFFRU4sU0FBU0csZUFBZSxhQUNoQ0MsSUFBTUcsRUFFZixNQUFNQyxFQUFpQlIsU0FBU3RELGNBQWMsOEJBQ3hDK0QsRUFBbUJULFNBQVN0RCxjQUFjLHVCQUUxQ2dFLEVBQWtCVixTQUFTVyxNQUFNQyxRQUVqQ0MsRUFBYWIsU0FBU3RELGNBQWMsMEJBQ3BDb0UsRUFBZWQsU0FBU3RELGNBQWMsbUJBRXRDcUUsRUFBY2YsU0FBU1csTUFBTUssUUFFN0JDLEVBQWtCakIsU0FBU3RELGNBQWMsc0JBQ3pDd0UsRUFBZ0JsQixTQUFTdEQsY0FBYyxzQkFDdkN5RSxFQUFzQm5CLFNBQVN0RCxjQUFjLHNCQUU3QzBFLEVBQWdCcEIsU0FBU3RELGNBQWMsNkJBQ3ZDMkUsRUFBa0JyQixTQUFTdEQsY0FBYyxzQkFDekM0RSxFQUFpQnRCLFNBQVNXLE1BQU01QixPQUNoQ3dDLEVBQWtCdkIsU0FBU3RELGNBQWMsc0JBR3pDOEUsRUFBcUJ4QixTQUFTdEQsY0FBYyxvQkFDNUMrRSxFQUFjRCxFQUFtQjlFLGNBQWMsa0JBQy9DZ0YsRUFBcUJGLEVBQW1COUUsY0FDNUMseUJBSUlpRixFQUFtQmxCLEVBQWlCL0QsY0FBYyx1QkFDbERrRixFQUNKbkIsRUFBaUIvRCxjQUFjLG1CQUUzQm1GLEVBQWlCZixFQUFhcEUsY0FBYyxxQkFDNUNvRixFQUFlaEIsRUFBYXBFLGNBQWMsa0JBRTFDcUYsRUFBZ0IvQixTQUFTdEQsY0FBYyxnQkFHdkNzRixFQUFhaEMsU0FBU3RELGNBQWMsZ0JBQ3BDdUYsRUFBb0JELEVBQVd0RixjQUFjLGlCQUM3Q3dGLEVBQVVGLEVBQVd0RixjQUFjLG1CQUVuQ3lGLEVBQWVuQyxTQUFTdEQsY0FBYyxrQkFBa0IwRixRQUk5RCxJQUFJQyxFQUNBQyxFQUVKLFNBQVNDLEVBQWFDLEdBQ0osV0FBWkEsRUFBSUMsS0FFTkMsRUFEa0IxQyxTQUFTdEQsY0FBYyxvQkFHN0MsQ0E2Q0EsU0FBU2lHLEVBQVVDLEdBQ2pCQSxFQUFNaEcsVUFBVUcsSUFBSSxtQkFDcEJpRCxTQUFTNkMsaUJBQWlCLFVBQVdOLEVBQ3ZDLENBRUEsU0FBU0csRUFBV0UsR0FDbEJBLEVBQU1oRyxVQUFVQyxPQUFPLG1CQUN2Qm1ELFNBQVM4QyxvQkFBb0IsVUFBV1AsRUFDMUMsQ0ErRUEsU0FBU1EsRUFBV0MsRUFBTXRFLEVBQVMsV0FDakMsTUFBTXVFLEVBeEhSLFNBQXdCQyxHQUN0QixNQUFNRCxFQUFjZCxFQUFhekYsY0FBYyxTQUFTeUcsV0FBVSxHQUM1REMsRUFBWUgsRUFBWXZHLGNBQWMsZUFDdEMyRyxFQUFZSixFQUFZdkcsY0FBYyxnQkFFNUMyRyxFQUFVQyxhQUFhLE1BQU9KLEVBQUtqRSxNQUNuQ29FLEVBQVVDLGFBQWEsTUFBT0osRUFBSzFFLE1BQ25DNEUsRUFBVXRHLFlBQWNvRyxFQUFLMUUsS0FFN0IsTUFBTStFLEVBQWNOLEVBQVl2RyxjQUFjLG1CQW9COUMsT0FuQkl3RyxFQUFLTSxTQUNQRCxFQUFZM0csVUFBVTZHLE9BQU8sd0JBRS9CRixFQUFZVixpQkFBaUIsUUFBVUwsSUFzSHpDLElBQXdCa0IsRUFBU3ZFLEVBQVR1RSxFQXJITGxCLEVBQUltQixPQXFIVXhFLEVBckhGK0QsRUFBS1UsSUFBS1YsRUFBS00sUUE0SDFDOUYsRUFDRzJCLFlBQVlGLEdBQ1pmLEtBQUssSUFBTXNGLEVBQVE5RyxVQUFVNkcsT0FBTyx5QkFDcENJLE1BQU9DLEdBQVFDLFFBQVFDLE1BQU1GLElBUmhDcEcsRUFDRzBCLFNBQVNELEdBQ1RmLEtBQUssSUFBTXNGLEVBQVE5RyxVQUFVNkcsT0FBTyx5QkFDcENJLE1BQU9DLEdBQVFDLFFBQVFDLE1BQU1GLE1BdkhaYixFQUFZdkcsY0FBYyxxQkFDbENtRyxpQkFBaUIsUUFBVUwsS0EyRzNDLFNBQTBCUyxFQUFhOUQsR0FDckNrRCxFQUFlWSxFQUNmWCxFQUFpQm5ELEVBQ2pCd0QsRUFBVTFCLEVBQ1osQ0E5R0lnRCxDQUFpQmhCLEVBQWFDLEVBQUtVLE9BR3JDUCxFQUFVUixpQkFBaUIsUUFBUyxLQUNsQ1osRUFBa0JxQixhQUFhLE1BQU9KLEVBQUtqRSxNQUMzQ2dELEVBQWtCcUIsYUFBYSxNQUFPSixFQUFLMUUsTUFDM0MwRCxFQUFRcEYsWUFBY29HLEVBQUsxRSxLQUMzQm1FLEVBQVVYLEtBR0xpQixDQUNULENBMEZzQmlCLENBQWVsQixHQUVuQ2pCLEVBQWNyRCxHQUFRdUUsRUFDeEIsQ0E2REEsU0FBU2tCLEVBQVlMLEVBQUt0QixHQUN4QnVCLFFBQVFLLElBQUlKLE9BQ1p4QixFQUFJNkIsVUFBVTVHLFVBQVcsQ0FDM0IsQ0FFQSxTQUFTNkcsRUFBYzlCLEdBQ3JCQSxFQUFJNkIsVUFBVXZILFlBQWMsT0FDNUJTLEVBQWNpRixFQUFJNkIsVUFBV3ZJLEVBQy9CLENEbk5pQ1UsTUNKbEJ3RCxTQUFTdUUsaUJBQWlCLFVBWWxDQyxRQUFTNUIsSUFDZEEsRUFBTUMsaUJBQWlCLFlBQWNMLEtBRWpDQSxFQUFJbUIsU0FBV2YsR0FDZkosRUFBSW1CLE9BQU8vRyxVQUFVNkgsU0FBUyxzQkFFOUIvQixFQUFXRSxPQStDakJ4QixFQUFjeUIsaUJBQWlCLFFBQVMsS0FDdENGLEVBQVV0QixLQUdaYixFQUFlcUMsaUJBQWlCLFFBQVMsV0FDdkNGLEVBQVVsQyxHQUNWa0IsRUFBaUIrQyxNQUFRakQsRUFBWTNFLFlBQ3JDOEUsRUFBd0I4QyxNQUFRaEQsRUFBbUI1RSxZRDFGdEI2SCxFQUFDckksRUFBYVcsRUFBV1QsS0FDdERTLEVBQVV1SCxRQUFTSSxJQUNqQnZJLEVBQWVDLEVBQWFzSSxFQUFPcEksS0FFckMsTUFBTVUsRUFBZ0JaLEVBQVlJLGNBQWNGLEVBQU9QLHNCQUN2RGUsRUFBa0JDLEVBQVdDLEVBQWVWLElDc0Y1Q21JLENBQ0VqRSxFQUNBLENBQUNpQixFQUFrQkMsR0FDbkI5RixFQUVKLEdBRUErRSxFQUFXZ0MsaUJBQWlCLFFBQVMsV0FDbkNGLEVBQVU3QixFQUNaLEdBRUFKLEVBQWdCbUMsaUJBQWlCLFNBQVdMLElBQzFDQSxFQUFJcUMsaUJBQ0osTUFBTXJHLEVBQU9tRCxFQUFpQitDLE1BQ3hCakcsRUFBUW1ELEVBQXdCOEMsTUFDdENsQyxFQUFJNkIsVUFBVXZILFlBQWMsWUFDNUIwRixFQUFJNkIsVUFBVTVHLFVBQVcsRUFDekJDLEVBQ0dhLGFBQWEsQ0FBRUMsT0FBTUMsVUFDckJMLEtBQU1xQixJQUNMTSxFQUFnQmpELFlBQWMyQyxFQUFJakIsS0FDbEN5QixFQUFpQm5ELFlBQWMyQyxFQUFJaEIsTUFDbkNpRSxFQUFXakMsS0FFWm9ELE1BQU9DLEdBQVFLLEVBQVlMLEVBQUt0QixJQUNoQ3NDLFFBQVEsSUFBTVIsRUFBYzlCLE1BR2pDckIsRUFBb0IwQixpQkFBaUIsUUFBUyxLQUM1Q0gsRUFBV3pCLEtBR2JGLEVBQVk4QixpQkFBaUIsU0FBV0wsSUFDdENBLEVBQUlxQyxpQkFDSixNQUFNckcsRUFBT3NELEVBQWE0QyxNQUNwQnpGLEVBQU80QyxFQUFlNkMsTUFDNUJsQyxFQUFJNkIsVUFBVXZILFlBQWMsWUFDNUIwRixFQUFJNkIsVUFBVTVHLFVBQVcsRUFDekJDLEVBQ0dzQixRQUFRLENBQUVSLE9BQU1TLFNBQ2hCYixLQUFNcUIsSUFDTHNELEVBQVd0RCxHQUNYc0IsRUFBWWdFLFFBQ1pyQyxFQUFXNUIsS0FFWitDLE1BQU9DLEdBQVFLLEVBQVlMLEVBQUt0QixJQUNoQ3NDLFFBQVEsSUFBTVIsRUFBYzlCLE1BR2pDdEIsRUFBYzJCLGlCQUFpQixRQThDL0IsV0FDRTNCLEVBQWNwRSxZQUFjLGNBQzVCWSxFQUNHd0IsV0FBV29ELEdBQ1hsRSxLQUFLLEtBQ0ppRSxFQUFheEYsU0FDYjZGLEVBQVd6QixLQUVaNEMsTUFBT0MsR0FBUUMsUUFBUUMsTUFBTUYsSUFDN0JnQixRQUFRLEtBQ1A1RCxFQUFjcEUsWUFBYyxVQUVsQyxHQXhEQXdFLEVBQWV1QixpQkFBaUIsU0FBV0wsSUFDekNBLEVBQUlxQyxpQkFDSixNQUFNNUYsRUFBT3NDLEVBQWdCbUQsTUFDN0JsQyxFQUFJNkIsVUFBVXZILFlBQWMsWUFDNUIwRixFQUFJNkIsVUFBVTVHLFVBQVcsRUFDekJDLEVBQ0dvQixlQUFlRyxHQUNmYixLQUFNcUIsSUFDTFMsRUFBa0JFLElBQU1YLEVBQUlWLE9BQzVCMkQsRUFBV3JCLEdBQ1hDLEVBQWV5RCxVQUVoQmxCLE1BQU9DLEdBQVFLLEVBQVlMLEVBQUt0QixJQUNoQ3NDLFFBQVEsSUFBTVIsRUFBYzlCLE1EcklBaEcsRUNxTmhCVixFRHBORWtKLE1BQU1DLEtBQUtqRixTQUFTdUUsaUJBQWlCL0gsRUFBT1QsZUFDcER5SSxRQUFTbEksSUFDaEJBLEVBQVl1RyxpQkFBaUIsU0FBVSxTQUFVTCxHQUMvQ0EsRUFBSXFDLGdCQUNOLEdBbkJzQkssRUFBQzVJLEVBQWFFLEtBQ3RDLE1BQU1TLEVBQVkrSCxNQUFNQyxLQUN0QjNJLEVBQVlpSSxpQkFBaUIvSCxFQUFPUixnQkFFaENrQixFQUFnQlosRUFBWUksY0FBY0YsRUFBT1Asc0JBQ3ZEZSxFQUFrQkMsRUFBV0MsRUFBZVYsR0FDNUNTLEVBQVV1SCxRQUFTakksSUFDakJBLEVBQWFzRyxpQkFBaUIsUUFBUyxXQXBEaEJzQyxFQUFDN0ksRUFBYUMsRUFBY0MsS0FDaERELEVBQWFhLFNBQVNDLE1BUXpCaEIsRUFBZUMsRUFBYUMsRUFBY0MsR0F2QnZCNEksRUFBQzlJLEVBQWFDLEVBQWM4SSxFQUFjN0ksS0FDL0QsTUFBTUMsRUFBZUgsRUFBWUksY0FBYyxJQUFJSCxFQUFhSSxZQUNoRUosRUFBYUssVUFBVUcsSUFBSVAsRUFBT0wsaUJBQ2xDTSxFQUFhSyxZQUFjdUksRUFDM0I1SSxFQUFhRyxVQUFVRyxJQUFJUCxFQUFPSixhQVloQ2dKLENBQ0U5SSxFQUNBQyxFQUNBQSxFQUFhK0ksa0JBQ2I5SSxJQStDQTJJLENBQW1CN0ksRUFBYUMsRUFBY0MsR0FDOUNRLEVBQWtCQyxFQUFXQyxFQUFlVixFQUM5QyxNQVVBMEksQ0FBa0I1SSxFQUFhRSxLQzhLakNrQixFQUNHNEIsZUFDQWxCLEtBQU1tSCxJQUNMLE1BQU9DLEVBQVdDLEdBQVlGLEVBUTlCeEYsRUFBZ0JqRCxZQUFjMkksRUFBU2pILEtBQ3ZDeUIsRUFBaUJuRCxZQUFjMkksRUFBU2hILE1BQ3hDeUIsRUFBa0JFLElBQU1xRixFQUFTMUcsT0FHakN5RyxFQUFVaEIsUUFBU2tCLEdBQVMzQyxFQUFXMkMsRUFBTSxhQUU5QzdCLE1BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9JbnNlcnQgcHJvamVjdCBuYW1lL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vSW5zZXJ0IHByb2plY3QgbmFtZS8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRlLmpzIiwid2VicGFjazovL0luc2VydCBwcm9qZWN0IG5hbWUvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vSW5zZXJ0IHByb2plY3QgbmFtZS8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0XCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0X3R5cGVfZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmVycm9yQ2xhc3MpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihcclxuICAgICAgZm9ybUVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudCxcclxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxyXG4gICAgICBjb25maWdcclxuICAgICk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGVuYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbn07XHJcblxyXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0LCBjb25maWcpO1xyXG4gIH0pO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICByZXNldFZhbGlkYXRpb24sXHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICBkaXNhYmxlQnV0dG9uLFxyXG4gIHZhbGlkYXRpb25Db25maWcsXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGUuanNcIjtcclxuXHJcbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvaWNvbnMvbG9nby5zdmdcIjtcclxuaW1wb3J0IGVkaXRJY29uU3JjIGZyb20gXCIuLi9pbWFnZXMvaWNvbnMvZWRpdC1pY29uLnN2Z1wiO1xyXG5pbXBvcnQgcGx1c0ljb25TcmMgZnJvbSBcIi4uL2ltYWdlcy9pY29ucy9wbHVzLnN2Z1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjZlNThiMmRiLThjNmItNDc2NS1iNDRmLTg5Yzc3YzU1MzgxNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCB1c2VyUHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHVzZXJQcm9maWxlQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCB1c2VyUHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5cclxuLy9pbWFnZSBpbXBvcnRzXHJcbmNvbnN0IHNwb3RzTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3BvdHMtbG9nb1wiKTtcclxuc3BvdHNMb2dvLnNyYyA9IGxvZ29TcmM7XHJcblxyXG5jb25zdCBlZGl0SWNvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1pY29uXCIpO1xyXG5lZGl0SWNvbi5zcmMgPSBlZGl0SWNvblNyYztcclxuXHJcbmNvbnN0IHBsdXNJY29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwbHVzLWljb25cIik7XHJcbnBsdXNJY29uLnNyYyA9IHBsdXNJY29uU3JjO1xyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtcHJvZmlsZS1idG5cIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcclxuLy8gY29uc3QgZWRpdFByb2ZpbGVDbG9zZUJ0biA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtcy5wcm9maWxlO1xyXG5cclxuY29uc3QgbmV3UG9zdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmV3LXBvc3QtYnRuXCIpO1xyXG5jb25zdCBuZXdQb3N0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy1wb3N0LW1vZGFsXCIpO1xyXG4vLyBjb25zdCBuZXdQb3N0Q2xvc2VCdG4gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBuZXdQb3N0Rm9ybSA9IGRvY3VtZW50LmZvcm1zLm5ld1Bvc3Q7XHJcblxyXG5jb25zdCBkZWxldGVDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVDYXJkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZGVsZXRlLWJ0blwiKTtcclxuY29uc3QgY2FuY2VsRGVsZXRlQ2FyZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhbmNlbC1idG5cIik7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItZWRpdC1idG5cIik7XHJcbmNvbnN0IGVkaXRBdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1hdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRBdmF0YXJGb3JtID0gZG9jdW1lbnQuZm9ybXMuYXZhdGFyO1xyXG5jb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1saW5rLWlucHV0XCIpO1xyXG5cclxuLy8gZ2V0IHByb2ZpbGUgbmFtZSBhbmQgZGVzY3JpcHRpb25cclxuY29uc3QgcHJvZmlsZUluZm9ybWF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19jb2x1bW5cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gcHJvZmlsZUluZm9ybWF0aW9uLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gcHJvZmlsZUluZm9ybWF0aW9uLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5cclxuLy8gZ2V0IGlucHV0IGVsZW1lbnRzIGZyb20gdGhlIG1vZGFsc1xyXG5jb25zdCBwcm9maWxlTmFtZUlucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPVxyXG4gIGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNkZXNjcmliZS1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IGltYWdlTGlua0lucHV0ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtbGluay1pbnB1dFwiKTtcclxuY29uc3QgY2FwdGlvbklucHV0ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjY2FwdGlvbi1pbnB1dFwiKTtcclxuXHJcbmNvbnN0IGNhcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xyXG5cclxuLy9tb2RhbCBwcmV2aWV3IGVsZW1lbnRzXHJcbmNvbnN0IG1vZGFsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWltYWdlXCIpO1xyXG5jb25zdCBtb2RhbEltYWdlUHJldmlldyA9IG1vZGFsSW1hZ2UucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbmNvbnN0IGNhcHRpb24gPSBtb2RhbEltYWdlLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcblxyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudDtcclxuXHJcbmNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcblxyXG5sZXQgc2VsZWN0ZWRDYXJkO1xyXG5sZXQgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfaXMtb3BlbmVkXCIpO1xyXG4gICAgY2xvc2VNb2RhbChvcGVuTW9kYWwpO1xyXG4gIH1cclxufVxyXG5cclxubW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGV2dC50YXJnZXQgPT09IG1vZGFsIHx8XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlLWJ0blwiKVxyXG4gICAgKSB7XHJcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGV4dFwiKTtcclxuICBjb25zdCBjYXJkSW1hZ2UgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG5cclxuICBjYXJkSW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIGRhdGEubGluayk7XHJcbiAgY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBkYXRhLm5hbWUpO1xyXG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuXHJcbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnRuXCIpO1xyXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcclxuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcclxuICB9XHJcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIGhhbmRsZUxpa2VDYXJkKGV2dC50YXJnZXQsIGRhdGEuX2lkLCBkYXRhLmlzTGlrZWQpO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xyXG4gIGNhcmREZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEuX2lkKTtcclxuICB9KTtcclxuXHJcbiAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBtb2RhbEltYWdlUHJldmlldy5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgZGF0YS5saW5rKTtcclxuICAgIG1vZGFsSW1hZ2VQcmV2aWV3LnNldEF0dHJpYnV0ZShcImFsdFwiLCBkYXRhLm5hbWUpO1xyXG4gICAgY2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIG9wZW5Nb2RhbChtb2RhbEltYWdlKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZSk7XHJcbn1cclxuXHJcbmVkaXRBdmF0YXJCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoZWRpdEF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG5lZGl0UHJvZmlsZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gIG9wZW5Nb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcclxuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgZWRpdFByb2ZpbGVGb3JtLFxyXG4gICAgW3Byb2ZpbGVOYW1lSW5wdXQsIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0XSxcclxuICAgIHZhbGlkYXRpb25Db25maWdcclxuICApO1xyXG59KTtcclxuXHJcbm5ld1Bvc3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcclxufSk7XHJcblxyXG5lZGl0UHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgbmFtZSA9IHByb2ZpbGVOYW1lSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgYWJvdXQgPSBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcclxuICBldnQuc3VibWl0dGVyLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICBldnQuc3VibWl0dGVyLmRpc2FibGVkID0gdHJ1ZTtcclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICB1c2VyUHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSByZXMubmFtZTtcclxuICAgICAgdXNlclByb2ZpbGVBYm91dC50ZXh0Q29udGVudCA9IHJlcy5hYm91dDtcclxuICAgICAgY2xvc2VNb2RhbChlZGl0UHJvZmlsZU1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gaGFuZGxlRXJyb3IoZXJyLCBldnQpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gaGFuZGxlRmluYWxseShldnQpKTtcclxufSk7XHJcblxyXG5jYW5jZWxEZWxldGVDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChkZWxldGVDYXJkTW9kYWwpO1xyXG59KTtcclxuXHJcbm5ld1Bvc3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IG5hbWUgPSBjYXB0aW9uSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgbGluayA9IGltYWdlTGlua0lucHV0LnZhbHVlO1xyXG4gIGV2dC5zdWJtaXR0ZXIudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gIGV2dC5zdWJtaXR0ZXIuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcclxuICAgICAgbmV3UG9zdEZvcm0ucmVzZXQoKTtcclxuICAgICAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBoYW5kbGVFcnJvcihlcnIsIGV2dCkpXHJcbiAgICAuZmluYWxseSgoKSA9PiBoYW5kbGVGaW5hbGx5KGV2dCkpO1xyXG59KTtcclxuXHJcbmRlbGV0ZUNhcmRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcblxyXG5lZGl0QXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBjb25zdCBsaW5rID0gYXZhdGFyTGlua0lucHV0LnZhbHVlO1xyXG4gIGV2dC5zdWJtaXR0ZXIudGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gIGV2dC5zdWJtaXR0ZXIuZGlzYWJsZWQgPSB0cnVlO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VyQXZhdGFyKGxpbmspXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHVzZXJQcm9maWxlQXZhdGFyLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICAgIGNsb3NlTW9kYWwoZWRpdEF2YXRhck1vZGFsKTtcclxuICAgICAgZWRpdEF2YXRhckZvcm0ucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gaGFuZGxlRXJyb3IoZXJyLCBldnQpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gaGFuZGxlRmluYWxseShldnQpKTtcclxufSk7XHJcblxyXG4vLyBUaGUgZnVuY3Rpb24gYWNjZXB0cyBhIGNhcmQgb2JqZWN0IGFuZCBhIG1ldGhvZCBvZiBhZGRpbmcgdG8gdGhlIHNlY3Rpb25cclxuLy8gVGhlIG1ldGhvZCBpcyBpbml0aWFsbHkgYHByZXBlbmRgLCBidXQgeW91IGNhbiBwYXNzIGBhcHBlbmRgXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoaXRlbSwgbWV0aG9kID0gXCJwcmVwZW5kXCIpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xyXG4gIC8vIEFkZCB0aGUgY2FyZCBpbnRvIHRoZSBzZWN0aW9uIHVzaW5nIHRoZSBtZXRob2RcclxuICBjYXJkQ29udGFpbmVyW21ldGhvZF0oY2FyZEVsZW1lbnQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkSWQpIHtcclxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcclxuICBzZWxlY3RlZENhcmRJZCA9IGNhcmRJZDtcclxuICBvcGVuTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNhcmQobGlrZUJ0biwgY2FyZElkLCBjYXJkSXNMaWtlZCkge1xyXG4gIGlmICghY2FyZElzTGlrZWQpIHtcclxuICAgIGFwaVxyXG4gICAgICAubGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigoKSA9PiBsaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAuZGlzbGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigoKSA9PiBsaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoKSB7XHJcbiAgZGVsZXRlQ2FyZEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBkZWxldGVDYXJkQnRuLnRleHRDb250ZW50ID0gXCJEZWxldGVcIjtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBFbnN1cmVzIHVzZXIgaW5mb3JtYXRpb24gIGFuZCBjYXJkcyBhcmUgbG9hZGVkIG9uIHN0YXJ0dXBcclxuZnVuY3Rpb24gc3RhcnRVcFNwb3RzKCkge1xyXG4gIGFwaVxyXG4gICAgLnNwb3RzU3RhcnRVcCgpXHJcbiAgICAudGhlbigocmVzdWx0cykgPT4ge1xyXG4gICAgICBjb25zdCBbY2FyZHNEYXRhLCB1c2VySW5mb10gPSByZXN1bHRzOyAvLyBkZXN0cnVjdHVyaW5nIHRoZSBhcnJheVxyXG5cclxuICAgICAgLy8gTm93IHlvdSBjYW4gdXNlIGVhY2ggcGllY2Ugb2YgZGF0YTpcclxuICAgICAgLy8gY2FyZHNEYXRhIGNvbnRhaW5zIHRoZSBjYXJkcyBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgICAgLy8gdXNlckluZm8gY29udGFpbnMgdGhlIHVzZXIgaW5mb3JtYXRpb25cclxuXHJcbiAgICAgIC8vIFByb2Nlc3MgdXNlciBpbmZvIGZpcnN0XHJcbiAgICAgIC8vIFVwZGF0ZSBwcm9maWxlIG5hbWUsIGFib3V0LCBhdmF0YXIsIGV0Yy5cclxuICAgICAgdXNlclByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcclxuICAgICAgdXNlclByb2ZpbGVBYm91dC50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xyXG4gICAgICB1c2VyUHJvZmlsZUF2YXRhci5zcmMgPSB1c2VySW5mby5hdmF0YXI7XHJcbiAgICAgIC8vIFRoZW4gcmVuZGVyIHRoZSBjYXJkc1xyXG4gICAgICAvLyBDcmVhdGUgYW5kIGRpc3BsYXkgdGhlIGNhcmRzIG9uIHRoZSBwYWdlXHJcbiAgICAgIGNhcmRzRGF0YS5mb3JFYWNoKChjYXJkKSA9PiByZW5kZXJDYXJkKGNhcmQsIFwiYXBwZW5kXCIpKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7IC8vIEhhbmRsZSBhbnkgZXJyb3JzXHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRXJyb3IoZXJyLCBldnQpIHtcclxuICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgZXZ0LnN1Ym1pdHRlci5kaXNhYmxlZCA9IGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVGaW5hbGx5KGV2dCkge1xyXG4gIGV2dC5zdWJtaXR0ZXIudGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICBkaXNhYmxlQnV0dG9uKGV2dC5zdWJtaXR0ZXIsIHZhbGlkYXRpb25Db25maWcpO1xyXG59XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xyXG5zdGFydFVwU3BvdHMoKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGxpbmsgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGNhcmRJZCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBjYXJkSWQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgY2FyZElkLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvL3JldHVybnMgUHJvbWlzZS5hbGwoKSB0byBlbnN1cmUgYm90aCB1c2VyIGluZm8gYW5kIGNhcmRzIGFyZSByZXR1cm5lZCBieSB0aGUgYXBpIGJlZm9yZSBkaXNwbGF5aW5nIGFueXRoaW5nXHJcbiAgc3BvdHNTdGFydFVwKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJhZGQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJlbmFibGVCdXR0b24iLCJkaXNhYmxlZCIsImFwaSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInRoaXMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJfY2hlY2tSZXNwb25zZSIsImdldFVzZXJJbmZvIiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0VXNlckF2YXRhciIsImF2YXRhciIsImFkZENhcmQiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJzcG90c1N0YXJ0VXAiLCJQcm9taXNlIiwiYWxsIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiYXV0aG9yaXphdGlvbiIsInVzZXJQcm9maWxlTmFtZSIsImRvY3VtZW50IiwidXNlclByb2ZpbGVBYm91dCIsInVzZXJQcm9maWxlQXZhdGFyIiwiZ2V0RWxlbWVudEJ5SWQiLCJzcmMiLCJsb2dvU3JjIiwiZWRpdEljb25TcmMiLCJwbHVzSWNvblNyYyIsImVkaXRQcm9maWxlQnRuIiwiZWRpdFByb2ZpbGVNb2RhbCIsImVkaXRQcm9maWxlRm9ybSIsImZvcm1zIiwicHJvZmlsZSIsIm5ld1Bvc3RCdG4iLCJuZXdQb3N0TW9kYWwiLCJuZXdQb3N0Rm9ybSIsIm5ld1Bvc3QiLCJkZWxldGVDYXJkTW9kYWwiLCJkZWxldGVDYXJkQnRuIiwiY2FuY2VsRGVsZXRlQ2FyZEJ0biIsImVkaXRBdmF0YXJCdG4iLCJlZGl0QXZhdGFyTW9kYWwiLCJlZGl0QXZhdGFyRm9ybSIsImF2YXRhckxpbmtJbnB1dCIsInByb2ZpbGVJbmZvcm1hdGlvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZU5hbWVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiaW1hZ2VMaW5rSW5wdXQiLCJjYXB0aW9uSW5wdXQiLCJjYXJkQ29udGFpbmVyIiwibW9kYWxJbWFnZSIsIm1vZGFsSW1hZ2VQcmV2aWV3IiwiY2FwdGlvbiIsImNhcmRUZW1wbGF0ZSIsImNvbnRlbnQiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImhhbmRsZUVzY2FwZSIsImV2dCIsImtleSIsImNsb3NlTW9kYWwiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVuZGVyQ2FyZCIsIml0ZW0iLCJjYXJkRWxlbWVudCIsImRhdGEiLCJjbG9uZU5vZGUiLCJjYXJkVGl0bGUiLCJjYXJkSW1hZ2UiLCJzZXRBdHRyaWJ1dGUiLCJjYXJkTGlrZUJ0biIsImlzTGlrZWQiLCJ0b2dnbGUiLCJsaWtlQnRuIiwidGFyZ2V0IiwiX2lkIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJoYW5kbGVEZWxldGVDYXJkIiwiZ2V0Q2FyZEVsZW1lbnQiLCJoYW5kbGVFcnJvciIsImxvZyIsInN1Ym1pdHRlciIsImhhbmRsZUZpbmFsbHkiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImNvbnRhaW5zIiwidmFsdWUiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsInByZXZlbnREZWZhdWx0IiwiZmluYWxseSIsInJlc2V0IiwiQXJyYXkiLCJmcm9tIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIiwicmVzdWx0cyIsImNhcmRzRGF0YSIsInVzZXJJbmZvIiwiY2FyZCJdLCJzb3VyY2VSb290IjoiIn0=